
<!DOCTYPE html>
<html>
    
    
<head>

    <title>After School Club</title>

    <!-- scripts and imports -->
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="lessons.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">

</head>

<body>
    <h1>After School Club</h1>

    <div id="app">
        <div class="sortedByDiv">sorted by 
            <select class="sortingFont" v-model="filter">
                <option value="subject">Subject</option>
                <option value="location">Location</option>
                <option value="price">Price</option>
                <option value="space">Space</option>
            </select>

            <input type="radio" id="asc" value="ascending" v-model="sortDirection">
            <label for="ascending">Ascending</label>
            <input type="radio" id="desc" value="descending" v-model="sortDirection">
            <label for="descending">Descending</label>
        </div>
            
        <div v-for="lesson in sortedLessons"> 
            <img v-bind:src="lesson.image" height="150">
            <h2>{{lesson.subject}}</h1>
            <p>Location: {{lesson.location}}</p>
            <p>Price: {{lesson.price}}</p>
            <p>Spaces: {{lesson.availableInventory - getItemCount(lesson.id)}}</p>
                
            <button @click="addToArray(lesson.id)" v-bind:disabled="!canAddToArray(lesson)">Add to array</button>
            
            <!-- <span v-if="itemCount(lesson) === 0">Nothing Added</span>
            <span v-else-if="itemCount(lesson) > 1">{{itemCount(lesson)}} added</span>
            <span v-else>Else</span> -->

            <br>
            <br>
        </div>
    </div>

    <script>
        
        const sorters = {
                subject_ascending: (a,b) => {let x = a.subject.toUpperCase(),
                                            y = b.subject.toUpperCase();
                                            return x == y ? 0 : x > y ? 1 : -1;},
                subject_descending: (a,b) => {let x = a.subject.toUpperCase(),
                                            y = b.subject.toUpperCase();
                                            return x == y ? 0 : x > y ? -1 : 1;},
                
                location_ascending: (a,b) => {let x = a.location.toUpperCase(),
                                            y = b.location.toUpperCase();
                                            return x == y ? 0 : x > y ? 1 : -1;},
                location_descending: (a,b) => {let x = a.location.toUpperCase(),
                                            y = b.location.toUpperCase();
                                            return x == y ? 0 : x > y ? -1 : 1;},

                price_ascending: (a,b) => a.price - b.price,
                price_descending: (a,b) => b.price - a.price,

                space_ascending: (a,b) => a.space - b.space,
                space_descending: (a,b) => b.space - a.space,
        };
        let app = new Vue({

            el: '#app',
            data: {
                lessons: lessons,
                cart: [],
                filter: "price",
                sortDirection: "ascending",
            },
            methods: {
                addToArray(id) {
                    this.cart.push(id);
                },
                canAddToArray(lesson) {
                    let id = lesson.id;
                    let itemCount = this.getItemCount(id);
                    let spaces = lesson.availableInventory;
                    return spaces > itemCount;
                },
                getItemCount(id){
                    let counter = 0;
                    for(i = 0; i < this.cart.length; i++){
                        if(this.cart[i] === id){
                            counter++;
                        }
                    }
                    return counter;
                },
                sortBy(attribute){
                    function compare(a, b){
                        if(a.subject > b.subject) return 1;
                        if(a.subject < b.subject) return -1;
                        return 0;
                    }
                    return this.lessons.sort(compare);
                }
            },

            computed: {
                // sortedLessons(){
                //     function compare(a, b){
                //         if(a.subject > b.subject) return 1;
                //         if(a.subject < b.subject) return -1;
                //         return 0;
                //     }
                //     return this.lessons.sort(compare);
                
                // }

                sortedLessons(){
                    return this.lessons.slice().sort(sorters[this.filter + "_" + this.sortDirection]);
                }
                
            }

        });
        
    </script>

</body>

</html>